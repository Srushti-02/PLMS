@model List<LoanDashboard.Models.Applicant>
@{
    Layout = null;
}
<!DOCTYPE html>
<html>
<head>
    <title>Loan Officer Dashboard</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" />
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="~/Scripts/httpHelper.js"></script>
</head>
<body>
    <nav class="navbar navbar-dark bg-dark px-4">
        <span class="navbar-brand">Loan Officer Dashboard</span>
        <div class="ms-auto">
            <a class="btn btn-outline-light me-2" href="@Url.Action("ChangePassword")">Change Password</a>
            <a class="btn btn-danger" href="@Url.Action("Logout")">Logout</a>
        </div>
    </nav>

    <div class="container mt-4">
        <h4>View Applicant Details</h4>
        <table class="table table-bordered mt-3">
            <thead class="table-dark">
                <tr>
                    <th>User ID</th>
                    <th>Application ID</th>
                    <th>Status</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var app in Model)
                {
                    <tr id="row-@app.ApplicationId">
                        <td>@app.UserId</td>
                        <td>@app.ApplicationId</td>
                        <td id="status-@app.ApplicationId">@app.Status</td>
                        <td>
                            <button class="btn btn-success btn-sm" onclick="approve('@app.ApplicationId')">Approve</button>
                            <button class="btn btn-danger btn-sm" onclick="disapprove('@app.ApplicationId')">Disapprove</button>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <script>
        function approve(applicationId) {
            httpHelper.post('@Url.Action("Approve")', { applicationId })
                .then(() => {
                    $('#status-' + applicationId).text('Approved');
                    alert('Application approved!');
                });
        }

        function disapprove(applicationId) {
            httpHelper.post('@Url.Action("Disapprove")', { applicationId })
                .then(() => {
                    $('#status-' + applicationId).text('Disapproved');
                    alert('Application disapproved!');
                });
        }
    </script>
</body>
</html>
